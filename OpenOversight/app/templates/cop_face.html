{% extends "base.html" %}

{% block content %}
<link href="{{ url_for('static', filename='css/cropper.css') }}" rel="stylesheet">
<script src="{{ url_for('static', filename='js/cropper.js') }}"></script>

<div class="container theme-showcase" role="main">
    <div class="row">
      <div class="col-md-9">
        <h1>OpenOversight Volunteer Image Tagging</h1>
      </div>
      <div class="col-md-3">
        <div class="panel panel-primary">
          <div class="panel-heading"><span class="glyphicon glyphicon glyphicon-alert" aria-hidden="true"></span></div>
          <div class="panel-body">
          New to working on images for OpenOversight? Or just need a refresher?  <a href="{{ url_for('main.get_tutorial') }}"><button type="button" class="btn btn-sm btn-primary">Launch Tutorial</button></a>
          </div>
        </div>
      </div>
    </div>

    <div class="row">
      <div class="col-md-6">
        <div>
          <img class="img-responsive" id="image" src="{{ url_for('static', filename='images/test_cop1.png') }}" alt="Picture">
        </div>
      </div>
      <div class="col-md-6">
        <h4>Selected Face</h4>

        <div class="row">
        <div class="col-md-6">
          <div class="preview"></div>
        </div>
        <div class="col-md-6"></div>
        </div>

        <h4>Find the officer in the roster</h4>
        <input type="text" class="form-control" id="roster-search">
        <p><a href=""><button type="button" class="btn btn-lg btn-primary">The selected face is of this officer in the roster.</button></a>
        <a href=""><button type="button" class="btn btn-lg btn-primary">I can't find the officer in the roster for this face.</button></a>

        <h4>Done with this image?</h4>
        <a href=""><button type="button" class="btn btn-lg btn-primary">There are no remaining police officers in this image to tag.</button></a>
        </p>
      </div>
    </div>
                <script>
                  $(function () {
                    var $previews = $('.preview');
                    $('#image').cropper({
                        build: function (e) {
                          var $clone = $(this).clone();
                          $clone.css({
                            display: 'block',
                            width: '100%',
                            minWidth: 0,
                            minHeight: 0,
                            maxWidth: 'none',
                            maxHeight: 'none'
                          });
                          $previews.css({
                            width: '100%',
                            overflow: 'hidden'
                          }).html($clone);
                        },
                        crop: function (e) {
                          var imageData = $(this).cropper('getImageData');
                          var previewAspectRatio = e.width / e.height;
                          $previews.each(function () {
                            var $preview = $(this);
                            var previewWidth = $preview.width();
                            var previewHeight = previewWidth / previewAspectRatio;
                            var imageScaledRatio = e.width / previewWidth;
                            $preview.height(previewHeight).find('img').css({
                              width: imageData.naturalWidth / imageScaledRatio,
                              height: imageData.naturalHeight / imageScaledRatio,
                              marginLeft: -e.x / imageScaledRatio,
                              marginTop: -e.y / imageScaledRatio
                            });
                          });
                        }
                      });
                  });
                </script>

</div>
{% endblock %}
